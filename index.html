<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visa Topup Myanmar</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <link rel="icon" type="image/png" href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjOd1ufKHkNXLPtTI4s1feQWObG7DwY1cpIkYwBbMJJqm7JOLEKrKMAdNIE565tOmPKGbm9Ku_SdUbsKXN6YcANjGBHMLvJpsQgelcjFabjrb2_TJGLssQLmQWOfDvFPd7A1erbv_IGfK626zMfMpVfNJtZNNtR2pIsOK0HTdLqXnProNxWiPaWwAvZ2Gez/s1600/Webp.net-resizeimage.png">
    
    <style>
        :root {
            --bg-primary-light: #ffffff;
            --bg-secondary-light: #f5f5f5;
            --text-primary-light: #000000;
            --text-secondary-light: #666666;
            --border-color-light: #e5e5e5;
            --bg-primary-dark: #0A0A0A;
            --bg-secondary-dark: #1A1A1A;
            --text-primary-dark: #ffffff;
            --text-secondary-dark: #A1A1AA;
            --border-color-dark: #27272A;
            --accent-blue: #3B82F6;
            --accent-blue-dark: #2563EB;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
            transition: background-color 0.5s ease-in-out, color 0.5s ease-in-out;
        }

        body.dark-theme { background: var(--bg-primary-dark); color: var(--text-primary-dark); }
        body.light-theme { background: var(--bg-primary-light); color: var(--text-primary-light); }

        /* --- Swiper Slider Custom CSS --- */
        .card-slider-section {
            width: 100%;
            padding: 40px 0;
            overflow: hidden;
        }

        .swiper {
            width: 100%;
            padding-bottom: 50px;
        }

        .swiper-slide {
            background-position: center;
            background-size: cover;
            width: 320px; /* Card size */
            height: auto;
            transition: 0.3s;
        }

        /* ဘေးကကတ်တွေကို နည်းနည်းမှိန်ထားပြီး အလယ်ကတ်ကို ကြည်အောင်လုပ်ခြင်း */
        .swiper-slide:not(.swiper-slide-active) {
            opacity: 0.4;
            filter: blur(1px);
        }

        .swiper-slide img {
            display: block;
            width: 100%;
            border-radius: 18px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.5);
        }

        .swiper-pagination-bullet {
            background: var(--accent-blue);
        }

        /* --- Header & Title --- */
        .header {
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(5px);
            transition: background 0.5s ease-in-out;
        }

        body.dark-theme .header { background: rgba(26, 26, 26, 0.8); border-bottom: 1px solid var(--border-color-dark); }
        body.light-theme .header { background: rgba(245, 245, 245, 0.8); border-bottom: 1px solid var(--border-color-light); }

        .logo { height: 40px; width: auto; }

        @keyframes flowGradient {
            100% { background-position: 0% 50%; }
            0% { background-position: 100% 50%; }
        }

        .site-title {
            font-size: 28px;
            font-weight: 600;
            margin: 0;
            text-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
            background: linear-gradient(90deg, var(--accent-blue-dark), var(--accent-blue), #ffffff, var(--accent-blue), var(--accent-blue-dark));
            background-size: 300% 100%;
            animation: flowGradient 3s linear infinite;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .theme-toggle {
            width: 44px; height: 44px; border-radius: 12px; border: none; cursor: pointer;
            display: flex; align-items: center; justify-content: center; font-size: 20px;
            transition: 0.3s;
        }

        body.dark-theme .theme-toggle { background: var(--bg-secondary-dark); color: #fff; }
        body.light-theme .theme-toggle { background: var(--bg-secondary-light); color: #000; }

        .opening-hours { text-align: right; padding: 10px 20px; color: silver; font-size: 14px; }

        /* --- Tables & Buttons --- */
        .exchange-table { width: 85%; max-width: 1000px; margin: 20px auto; border-radius: 16px; backdrop-filter: blur(12px); overflow: hidden; }
        .exchange-table table { width: 100%; border-collapse: collapse; }
        .exchange-table th { background: linear-gradient(135deg, var(--accent-blue), var(--accent-blue-dark)); color: white; padding: 15px; }
        .exchange-table td { padding: 12px; text-align: center; border: 1px solid rgba(255,255,255,0.1); }

        .fee-buttons { display: flex; justify-content: center; gap: 10px; margin: 20px; flex-wrap: wrap; }
        .fee-button { padding: 12px 20px; background: var(--accent-blue); color: white; border: none; border-radius: 8px; cursor: pointer; transition: 0.3s; }
        .fee-button:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4); }

        .footer { padding: 40px 20px; display: flex; justify-content: center; gap: 20px; border-top: 1px solid var(--border-color-dark); margin-top: 50px; }
        .social-button { width: 45px; height: 45px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; text-decoration: none; font-size: 20px; }
        
        /* Your Table Animations & Other Styles... */
        .loading-skeleton { background: linear-gradient(90deg, #222 0%, #333 50%, #222 100%); background-size: 200% 100%; animation: loadingShimmer 1.5s infinite; height: 15px; width: 80%; display: inline-block; border-radius: 4px; }
        @keyframes loadingShimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }

        #copyright-text { color: silver; text-align: center; font-size: 12px; margin-top: 20px; }

        @media (max-width: 768px) {
            .site-title { font-size: 18px; }
            .swiper-slide { width: 260px; }
        }
    </style>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="dark-theme">

    <header class="header">
        <div class="logo-section">
            <a href="index.html" style="display: flex; align-items: center; gap: 10px; text-decoration: none;">
                <img alt="Logo" class="logo" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiyYzrsGtCZ9Z18oQA9UDjT4dQp5pskqPam205oyGqEhDFr_FfLPIcFdbz7HOOXuViYH7ETAeazSnyf6IM6yCIKLVFNLpITVo-oGTd9zIVCNcGXFvPMnNqAbJh31RgiA-8fqNor-xgDLJme6j9Jiic5dXE7Nh8SGbqAzXjQ2reshMfc_XPnpUMfbbVnbsFD/s1600/VTM%20logo.png">
                <h1 class="site-title">Visa Topup Myanmar</h1>
            </a>
        </div>
        <button class="theme-toggle" onclick="toggleTheme()">
            <i class="fas fa-sun"></i>
        </button>
    </header>

    <div class="opening-hours">Open hours: 9AM to 9PM </div>

    <main>
        <section class="card-slider-section">
            <div class="swiper mySwiper">
                <div class="swiper-wrapper">
                    <div class="swiper-slide"><img src="assets/uab.png" alt="UAB Visa"></div>
                    <div class="swiper-slide"><img src="assets/aya.png" alt="AYA Visa"></div>
                    <div class="swiper-slide"><img src="assets/cb.png" alt="CB Visa"></div>
                </div>
                <div class="swiper-pagination"></div>
            </div>
        </section>

        <div class="exchange-table" id="rateTable">
            </div>
        
        <div class="update-time" id="updateTime"></div>

        <div class="fee-buttons">
            <button class="fee-button" onclick="showFeeTable('uab')">UAB Fee</button>
            <button class="fee-button" onclick="showFeeTable('aya')">AYA Fee</button>
            <button class="fee-button" onclick="showFeeTable('cb')">CB Fee</button>
            <button class="fee-button" onclick="showFeeTable('kbz')">KBZ Fee</button>
            <button class="fee-button" onclick="showFeeTable('mab')">MAB Fee</button>
        </div>

        <div class="fee-tables" id="feeTables"></div>
        
        <p id="copyright-text"></p>
    </main>

    <footer class="footer">
        <a class="social-button" style="background:#4CAF50" href="tel:+959770770640"><i class="fas fa-phone"></i></a>
        <a class="social-button" style="background:#0084FF" href="https://m.me/VisaTopup.mm"><i class="fab fa-facebook-messenger"></i></a>
        <a class="social-button" style="background:#1877F2" href="https://www.facebook.com/VisaTopup.mm"><i class="fab fa-facebook-f"></i></a>
        <a class="social-button" style="background:#0088cc" href="https://t.me/visatopupmm"><i class="fab fa-telegram"></i></a>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <script>
        // 1. Swiper Slider Configuration
        const swiper = new Swiper(".mySwiper", {
            effect: "coverflow",
            grabCursor: true,
            centeredSlides: true,
            slidesPerView: "auto",
            loop: true, // Infinite Loop
            autoplay: {
                delay: 3000,
                disableOnInteraction: false,
            },
            coverflowEffect: {
                rotate: 15,
                stretch: 0,
                depth: 300,
                modifier: 1,
                slideShadows: false,
            },
            pagination: {
                el: ".swiper-pagination",
                clickable: true,
            },
        });

        // 2. Original Theme & Functions
        function toggleTheme() {
            const body = document.body;
            const icon = document.querySelector('.theme-toggle i');
            const isDark = body.classList.contains('dark-theme');
            body.classList.toggle('dark-theme', !isDark);
            body.classList.toggle('light-theme', isDark);
            icon.className = isDark ? 'fas fa-moon' : 'fas fa-sun';
            localStorage.setItem('theme', isDark ? 'light' : 'dark');
        }

        // --- Fetch Rates & Others ---
        // (သင့်ရဲ့ ကျန်ရှိနေတဲ့ JavaScript function တွေကို ဒီအောက်မှာ ဆက်ထည့်နိုင်ပါတယ်)
        
        document.addEventListener('DOMContentLoaded', () => {
            // Copyright Year
            const copy = document.getElementById('copyright-text');
            if(copy) copy.textContent = `2019 - ${new Date().getFullYear()} copyright @Visa Topup Myanmar`;
            
            // Initial Theme
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.body.className = savedTheme + '-theme';

            // Start Fetching Data
            fetchRates();
        });

        async function fetchRates() {
            const rateTable = document.getElementById('rateTable');
            rateTable.innerHTML = `<div class="loading-skeleton" style="width:100%; height:200px;"></div>`;
            
            try {
                const res = await fetch('https://script.google.com/macros/s/AKfycbzh8uaqQeliA3ermIXm39XHnkXg5swV42dgb_Hoex-mTaTcdK3MeVPCwkoaBLxamCYl/exec');
                const data = await res.text();
                const rows = data.split('\n').map(r => r.split(','));
                
                let html = '<table><thead><tr>';
                rows[0].forEach(h => html += `<th>${h}</th>`);
                html += '</tr></thead><tbody>';
                for (let i = 1; i < rows.length; i++) {
                    if (!rows[i][0]) continue;
                    html += '<tr>';
                    rows[i].forEach((c, idx) => {
                        html += `<td>${idx > 0 && !isNaN(c) ? parseInt(c).toLocaleString() + ' Ks' : c}</td>`;
                    });
                    html += '</tr>';
                }
                html += '</tbody></table>';
                rateTable.innerHTML = html;
                document.getElementById('updateTime').textContent = "Last updated: " + new Date().toLocaleString();
            } catch (e) {
                rateTable.innerHTML = "Failed to load rates.";
            }
        }

        // showFeeTable function logic goes here...
    </script>
</body>
</html>
